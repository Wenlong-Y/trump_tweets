---
title: "Trump Tweet Habit Analysis"
author: "Wenlong Yang"
date: "11/4/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

President is one of the branch in our government. The behavior of the president and its impacts deserve great public attention. President Trump use twitter as a major way to communicate with the public. I want to find out more about Trump from his tweets. I also want to find out public opinions on different issues based on public reactions to Trump's tweets.

The data was downloaded from a [website](http://http://www.trumptwitterarchive.com/data/realdonaldtrump/) created by Brendan Brown. I extracted all of Trump's tweets from 2009 to Nov. 3rd 2019 as the total data. The size of the data is about 9 Mb.

```{r import and save data, echo = FALSE, include = FALSE}
library(tidyverse)
library(ggplot2)
library(lubridate)
library(tidyr)

all_tweets <- as_tibble(read.csv("trump_tweets_20191103.csv", stringsAsFactors=FALSE))

all_tweets <- all_tweets %>% mutate(datetime = as_datetime(created_at)) %>% mutate(year = year(datetime), month = month(datetime), day = day(datetime), hour = hour(datetime), minute = minute(datetime))

all_tweets %>% mutate(source = as.factor(source))

ttweets <- all_tweets %>% filter(source %in% c("Twitter for Android","Twitter for iPhone","Twitter Web Client"))


```

## The devices and how the distribution changes by year
First of all, let us take a look at the devices Trump use to send tweets. We will look at the statistics for the whole time between 2009 to 2019.

```{r trump tweet devices, echo=FALSE}
ttweets %>% ggplot(aes(source)) + geom_bar() + xlab("Devices") + ylab("Count") + ggtitle("Fig. 1. Trump tweeting devices")
```

Now, let us check the number of tweets by year.

```{r trump tweet by year, echo=FALSE}
ttweets %>% ggplot(aes(as.character(year), width = 1))+geom_bar() + ggtitle("Fig. 2. Trump tweets by year") + xlab("Year") + ylab("Count")
```

Let us check which device Trump uses to tweet during these years.

```{r calculate the percentage of use of each devices for each year, include=FALSE}

yearsource <- ttweets %>% group_by(year,source) %>% summarize(n=n())

year <- ttweets %>% group_by(year) %>% summarize(nyear=n())

full_join(yearsource,year)

yearsourcepercentage <- full_join(yearsource,year) %>% mutate(npercentage = n/nyear)



```

```{r plot the source by year, echo = FALSE}
yearsourcepercentage %>% ggplot(aes(year,npercentage,color=as.character(source)))+geom_line(aes(year,npercentage))+geom_point() + scale_x_continuous(breaks=seq(2009,2019,2)) + ggtitle("Fig. 3. Trump tweeting device by year") + labs(color="Device") + ylab("Percentage") + xlab("Year")
```

Seems that Trump was using web browsers only before 2012. At 2013, Trump started to use Android devices. Then he gradually shift from Android to Apple and phased out the web browser almost completely at 2019.
